<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> Character Sheet V0.0.0</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
</head>

<body>
    {% load static %}
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <nav class="navbar fixed-top navbar-light navbar-light bg-light">
        <div class="container-fluid justify-content-md-end">
            <a class="btn btn-primary btn-large" href="random"> Generate Random Inv.</a>
        </div>
    </nav>
    <div class="container" style="margin-top: 80px;">
        <!-- Basic Info -->
        {% include "inv_basic_info.html" %}
        <!-- Attributes -->
        {% include "inv_attributes.html" %}
        <!-- Skill -->
        {% include "inv_skills.html" %}
        <!-- Weapons -->
        {% include "inv_weapons.html" %}
        <!-- Backstory -->
        {% include "inv_backstory.html" %}
        <!-- Gear & Posession -->
        {% include "inv_gear.html" %}
    </div>
    {% block javascript %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous">
        </script>
    <!-- Skills Ajax -->
    <script type="module">
        import { skills } from '{% static "creator/js/skills.js" %}';
        $("#inv-skills").ready(
            function () {
                $.ajaxSetup({ cache: false });
                $.ajax({
                    url: "{% url 'inv_skills' res.investigator.uuid %}",
                    success: function (res) { skills(res) },
                    error: function (res) {
                        console.log(res);
                    }
                })
            });
    </script>
    <!-- Basic Info Ajax -->
    <script type="module">
        import { post_basic_info, get_basic_info } from '{% static "creator/js/basic_info.js" %}';

        $(document).ready(
            $("#basic-info").on('submit', function (evt) {
                evt.preventDefault();
                var csrftoken = $("[name=csrfmiddlewaretoken]").val();
                $.ajax({
                    url: "{% url 'basic_info' res.investigator.uuid %}",
                    type: "POST",
                    data: {
                        'name': $("#inv-name-inp").val(),
                        'sex': $("#inv-sex-inp").val(),
                        'age': $("#inv-age-inp").val(),
                        'player': $("#inv-player-inp").val(),
                        'residence': $("#inv-residence-inp").val(),
                        'birthplace': $("#inv-birthplace-inp").val(),
                        'occupation': $('#inv-occupation-inp').val()
                    },
                    beforeSend: function (xhr, settings) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    },
                    success: function (res) {
                        post_basic_info(res)
                    }
                })
            }));

        $("#basic-info").ready(
            $.ajaxSetup({ cache: false }),
            $.ajax({
                url: "{% url 'basic_info' res.investigator.uuid %}",
                success: function (res) {
                    get_basic_info(res)
                },
                error: function (res) {
                    console.log(res);
                }
            })
        );
    </script>
    <!-- Attributes Ajax -->
    <script type="module">
        import { get_attributes } from '{% static "creator/js/attributes.js" %}';
        $("#inv-attrs").ready(
            function () {
                $.ajax({
                    url: "{% url 'inv_attrs' res.investigator.uuid %}",
                    success: function (res) {
                        get_attributes(res)
                    },
                    error: function (res) {
                        console.log(res);
                    }
                })
            });
    </script>
    {% endblock %}
</body>


</html>